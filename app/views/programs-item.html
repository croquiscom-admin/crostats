<div ng-show='results'>
  <div id='chart'></div>
  <div class='table-scrollable'>
    <table class='table table-bordered table-condensed'>
      <tr>
        <th ng-i18next='programs.result.date'></th>
        <th ng-repeat='column in columns'>{{column}}</th>
        <th ng-show='program.show_total' ng-i18next='programs.result.total'></th>
      </tr>
      <tr ng-repeat='item in results'>
        <td>{{item.date}}</td>
        <td ng-repeat='value in item.result_for_table'>{{value}}</td>
        <td ng-show='program.show_total'>{{item.total}}</td>
      </tr>
    </table>
  </div>
</div>
<div ng-hide='results' ng-i18next='programs.result.no_result'>
</div>

<div id='program-edit-dialog' class='modal'>
  <div class='modal-dialog'>
    <div class='modal-content'>
      <div class='modal-header'>
        <button type='button' class='close' data-dismiss='modal'>&times;</button>
        <button type='submit' id='program-edit-save' class='btn btn-primary pull-right' ng-click='updateProgram()' ng-i18next='programs.edit.save' ng-disabled='isClean()'></button>
        <button type='submit' id='program-edit-reset' class='btn btn-default pull-right' ng-click='resetProgram()' ng-i18next='programs.edit.reset' ng-disabled='isClean()'></button>
        <h4 class='modal-title'><input type='text' ng-model='program.title'></input></h4>
      </div>
      <div class='modal-body'>
        <form>
          <div class='form-group'>
            <label>Description</label>
            <textarea class='form-control' rows='2' ng-model='program.description'></textarea>
          </div>
          <div class='form-group'>
            <label>Server</label>
            <select ng-model='program.server' ng-options='s._id as s._id for s in servers'>
              <option value=''>-- select server --</option>
            </select>
          </div>
          <div class='form-group'>
            <label>Show total</label>
            <input type='checkbox' class='form-control' ng-model='program.show_total'></textarea>
          </div>
          <div class='form-group'>
            <label>Type</label>
            <select ng-model='program.type' ng-options='type as label for (type, label) in types'></select>
          </div>
          <div class='form-group'>
            <label>Runner</label>
            <select ng-model='program.runner.type'>
              <option value=''>No runner</option>
              <option value='daily'>Daily</option>
            </select>
          </div>
          <ng-switch on='program.type'>
            <div class='form-group' ng-switch-when='shellscript'>
              <label>Script</label>
              <textarea class='form-control' rows='8' ng-model='program.script'></textarea>
            </div>
            <div class='form-group' ng-switch-when='mapreduce'>
              <label>Collection</label>
              <input type='text' class='form-control' ng-model='program.collection'></textarea>
              <label>Map function</label>
              <textarea class='form-control' rows='8' ng-model='program.map'></textarea>
              <label>Reduce function</label>
              <textarea class='form-control' rows='8' ng-model='program.reduce'></textarea>
            </div>
          </ng-switch>
          <button type='submit' class='btn btn-default' ng-click='runProgram()' ng-i18next='programs.edit.test'></button>
          <div ng-show='show_run_result'>
            <label ng-i18next='programs.edit.result'></label>
            <textarea class='form-control' rows='8' readonly>{{run_result.result | json}}</textarea>
            <button type='submit' class='btn btn-success' ng-click='recordTestResult()' ng-i18next='programs.edit.record_test_result'></button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
